<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <title>AR Check</title>
  <style>
    body { 
      margin: 0; 
      padding: 20px; 
      font-family: Arial; 
      font-size: 18px;
      line-height: 1.6;
    }
    .info { 
      background: #f0f0f0; 
      padding: 15px; 
      margin: 10px 0;
      border-radius: 5px;
    }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    button {
      padding: 15px 30px;
      font-size: 18px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      margin: 10px 0;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>WebXR Diagnostic Tool</h1>
  
  <div id="results"></div>
  <button id="test">Run AR Test</button>

  <script>
    const results = document.getElementById('results');
    const testBtn = document.getElementById('test');

    function log(message, type = 'info') {
      const div = document.createElement('div');
      div.className = 'info ' + type;
      div.innerHTML = message;
      results.appendChild(div);
    }

    // Check 1: Basic browser info
    log(`<strong>Browser:</strong> ${navigator.userAgent}`);
    
    // Check 2: HTTPS
    log(`<strong>Protocol:</strong> ${location.protocol}`, 
        location.protocol === 'https:' ? 'success' : 'error');
    
    // Check 3: navigator.xr exists
    if ('xr' in navigator) {
      log('<strong>navigator.xr:</strong> âœ“ Found', 'success');
      
      // Check 4: Session support
      navigator.xr.isSessionSupported('immersive-ar').then(supported => {
        if (supported) {
          log('<strong>immersive-ar:</strong> âœ“ Supported!', 'success');
          log('<strong>Result:</strong> Your device SHOULD work with WebXR AR!', 'success');
        } else {
          log('<strong>immersive-ar:</strong> âœ— Not supported', 'error');
          log(`<strong>Possible fixes:</strong><br>
            1. Enable Chrome flags:<br>
            &nbsp;&nbsp;chrome://flags/#webxr-incubations<br>
            &nbsp;&nbsp;chrome://flags/#webxr<br>
            2. Update Chrome to latest version<br>
            3. Check if ARCore is installed and updated<br>
            4. Try: <a href="https://immersive-web.github.io/webxr-samples/hit-test.html">Official WebXR Test</a>
          `, 'error');
        }
      }).catch(err => {
        log('<strong>Error checking support:</strong> ' + err.message, 'error');
      });
    } else {
      log('<strong>navigator.xr:</strong> âœ— Not found', 'error');
      log('<strong>Your browser does not support WebXR.</strong><br>Make sure you are using Chrome (not Firefox) on Android.', 'error');
    }

    // Test button
    testBtn.onclick = async () => {
      try {
        log('Attempting to request AR session...');
        const session = await navigator.xr.requestSession('immersive-ar', {
          requiredFeatures: ['local', 'hit-test']
        });
        log('<strong>SUCCESS!</strong> AR session started! ðŸŽ‰', 'success');
        session.end();
      } catch (err) {
        log('<strong>Failed to start AR:</strong> ' + err.message, 'error');
      }
    };
  </script>
</body>
</html>
